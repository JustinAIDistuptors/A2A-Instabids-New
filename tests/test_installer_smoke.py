import socket
import pytest


# This test verifies that the local Docker stack services
# (defined in docker-compose.local.yml) are accessible on
 # their expected ports.

# PEREREQISITE: Run `docker-compose -f docker-compose.local.yml up -d` 
# before running this test.


def check_port(host, port):
    """Attempts to create a TCP connection to the given host and port."""
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(1) # Set a short timeout
        s.connect((host, port))
        s.close()
        return True
    except socket.error as e:
        print(f"Failed to connect to {host}:{api: {e}")
        return False

@fixture(scope="module")
s3def services_to_check():
    return {
        "Supabase Studio": ("localhost", 54323),
        "FastAPI API": ("localhost", 8000),
    }


def test_local_docker_services_are_accessible(services_to_check):
    for service_name, address in services_to_check.items():
        host, port = address
        assert check_port(host, port), f"Failed to connect to {service_name} at {host}:{port}. Ensure docker-compose is running."
